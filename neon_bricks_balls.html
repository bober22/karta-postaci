<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Neon Bricks & Balls</title>
<style>
  body {
    margin: 0;
    background: #0a0b10;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    overflow: hidden;
  }
  canvas {
    background: radial-gradient(circle at center, #111 0%, #000 100%);
    display: block;
    border: 2px solid #0ff;
    border-radius: 10px;
    touch-action: none;
  }
</style>
</head>
<body>
<canvas id="gameCanvas" width="400" height="600"></canvas>
<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

let balls = [];
let angle = -Math.PI / 2; // start angle up
let isAiming = false;
let startX, startY;

function drawAimer() {
  ctx.strokeStyle = "#0ff";
  ctx.lineWidth = 2;
  ctx.beginPath();
  ctx.moveTo(canvas.width / 2, canvas.height - 20);
  ctx.lineTo(canvas.width / 2 + Math.cos(angle) * 50, canvas.height - 20 + Math.sin(angle) * 50);
  ctx.stroke();
}

function drawBalls() {
  ctx.fillStyle = "#0ff";
  balls.forEach(b => {
    ctx.beginPath();
    ctx.arc(b.x, b.y, 5, 0, Math.PI * 2);
    ctx.fill();
  });
}

function updateBalls() {
  balls.forEach(b => {
    b.x += b.vx;
    b.y += b.vy;
  });
  balls = balls.filter(b => b.y > 0 && b.x > 0 && b.x < canvas.width);
}

function shootBalls() {
  for (let i = 0; i < 10; i++) {
    let speed = 5;
    balls.push({
      x: canvas.width / 2,
      y: canvas.height - 20,
      vx: Math.cos(angle) * speed,
      vy: Math.sin(angle) * speed
    });
  }
}

function gameLoop() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawAimer();
  drawBalls();
  updateBalls();
  requestAnimationFrame(gameLoop);
}

// Obliczanie kąta
function updateAim(x, y) {
  let dx = x - canvas.width / 2;
  let dy = y - (canvas.height - 20);
  angle = Math.atan2(dy, dx);
  if (angle > -0.1) angle = -0.1; // ograniczenie, żeby nie strzelać w dół
  if (angle < -Math.PI + 0.1) angle = -Math.PI + 0.1;
}

// Obsługa myszki
canvas.addEventListener("mousedown", e => {
  isAiming = true;
  updateAim(e.offsetX, e.offsetY);
});
canvas.addEventListener("mousemove", e => {
  if (isAiming) updateAim(e.offsetX, e.offsetY);
});
canvas.addEventListener("mouseup", e => {
  isAiming = false;
  shootBalls();
});

// Obsługa dotyku
canvas.addEventListener("touchstart", e => {
  e.preventDefault();
  let rect = canvas.getBoundingClientRect();
  let touch = e.touches[0];
  isAiming = true;
  updateAim(touch.clientX - rect.left, touch.clientY - rect.top);
});
canvas.addEventListener("touchmove", e => {
  e.preventDefault();
  if (isAiming) {
    let rect = canvas.getBoundingClientRect();
    let touch = e.touches[0];
    updateAim(touch.clientX - rect.left, touch.clientY - rect.top);
  }
});
canvas.addEventListener("touchend", e => {
  e.preventDefault();
  isAiming = false;
  shootBalls();
});

gameLoop();
</script>
</body>
</html>